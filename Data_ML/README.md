# Data_ML

This directory is dedicated to data preprocessing and manipulation tasks necessary for preparing data for machine learning models. It includes various scripts, subfolders, and Excel files used to handle WESP-AC data.
The data generation code and csvs are seperated for understandability.
Our CSVS are seperated in order using 1_,2_ and 3_\* for classification and regression.
## Contents

### Subfolders
1. **wespacs**
   - Contains individual WESP-AC files for each site, generated by the `data_NRNB_to_wespac.ipynb` script.
2. **4_out_csvs_classification**
   - Stores CSV files with missing data filled by various methods for classification tasks.
3. **4_out_csvs_regression**
   - Stores CSV files with missing data filled by various methods for regression tasks.
4. **4_out_csvs_regression_norm**
   - Stores CSV files with missing data filled by various methods for regression tasks using normalized data.
5. **middle_csvs**
   - Stores intermediate CSV files used to generate the final files.

### Excel Files
1. **data_NRNB.xlsx**
   - Provided by Marc-Antoine from Natural Resources New Brunswick. It contains WESP-AC data (OF/F/S questionnaire answers only, no scores).
2. **wespac_3.3.xlsx**
   - WESP-AC Excel sheet (version 3.3). <b><span style="color:red">Removed for privacy</span></b>

3. **wespac_3.4.xlsx**
   - Adapted WESP-AC Excel sheet (from version 3.3) with updated benefit scores.<b><span style="color:red">Removed for privacy</span></b>
4. **WESP_extra.xlsx**
   - Extra features for each site, data was collected outside the WESP-AC.
   
### Excel Files (./middle_csvs)
1. **1_output_class.csv**
   - Generated by `wespac_to_csv_classification.ipynb`, containing classification data.
2. **1_output_regression.csv**
   - Generated by `wespac_to_csv_regression.ipynb`, containing regression data.
   
3. **2_output_class_removed_unc.csv**
   - Manually parsed CSV file with unnecessary columns removed from `1_output_class.csv`.
4. **2_output_reg_removed_unc.csv**
   - Manually parsed CSV file with unnecessary columns removed from `1_output_regression.csv`.
5. **2_output_reg_normalized_removed_unc.csv**
   - Manually parsed CSV file with unnecessary columns removed from `1_output_regression.csv`.
   
6. **3_output_class_rem_extra.csv**
   - Added etra features using `add_xtra.ipynb` from `2_output_class_removed_unc.csv`.
7. **3_output_reg_rem_extra.csv**
   - Added etra features using `add_xtra.ipynb` from `2_output_reg_removed_unc.csv`.
8. **3_output_reg_normalized_removed_extra.csv**
   - Added etra features using `add_xtra.ipynb` from `2_output_reg_normalized_removed_unc.csv`.
   
   
### Final datasets (multiple csv in folders)
   
1. **4_out_csvs_classification**
   - Data filled using `fill_missing_classification.ipynb` from `3_output_class_rem_extra.csv`.
2. **4_out_csvs_regression**
   - Data filled using `fill_missing_data_regression.ipynb` from `3_output_class_rem_extra.csv`.
3. **4_out_csvs_regression_norm**
   - Data filled using `fill_missing_data_regression.ipynb` from `3_output_class_rem_extra.csv`.



### Scripts
The scripts are divided in order using prefix such as 1_, 2_... to determine which order to launch them.
1. **data_NRNB_to_wespac.ipynb**
   - Converts `data_NRNB.xlsx` data to individual WESP-AC files using `wespac_3.4.xlsx`.
   - Output: Individual WESP-AC files in the `wespacs` folder.

2. **wespac_to_csv_classification.ipynb**
   - Compiles OF/F/S scores into a single CSV file (`output_class.csv`), assigning ratings (lower/moderate/higher) scores as 0, 1, 2.

3. **wespac_to_csv_regression.ipynb**
   - Compiles OF/F/S scores into a single CSV file (`output_regression.csv`), using raw (non-normalized) scores.
4. **wespac_to_csv_regression_normalized.ipynb**
   - Compiles OF/F/S scores into a single CSV file (`output_regression.csv`), using raw (non-normalized) scores.

5. **fill_missing_classification.ipynb**
   - Fills missing data in `output_class_removed_unc.csv` using nine methods.
   - Output: Filled CSV files saved in the `out_csvs_classification` folder.

6. **fill_missing_regression.ipynb**
   - Fills missing data in `output_reg_removed_unc.csv` using nine methods.
   - Output: Filled CSV files saved in the `out_csvs_regression` folder.

7. **add_xtra.ipynb.ipynb**
   - Add extra features to datasets. No need for filling but could be replaced.
   

8. **stats.ipynb**
   - Provide stats about the sites (such as the amount for each class).  
   

## Usage

### Data Conversion and Compilation
1. Run `data_NRNB_to_wespac.ipynb` to convert the data from `data_NRNB.xlsx` to individual WESP-AC files in the `wespacs` folder.
2. Use `wespac_to_csv_classification.ipynb` to compile classification data into `1_output_class.csv`.
3. Use `wespac_to_csv_regression.ipynb` to compile regression data into `1_output_regression.csv` or `wespac_to_csv_regression_normalized.ipynb` into `1_output_reg_normalized.csv`.
4. Manually clean the compiled CSV files to remove unnecessary columns, resulting in `2_output_class_removed_unc.csv`, `2_output_reg_removed_unc.csv` and `2_output_reg_norm_removed_unc.csv`.
5. Use `add_xtra.ipynb` to add extra features to either classification or regression (non/non-norm). resulting in `3_output_class_rem_extra.csv`, `3_output_reg_rem_extra.csv` and `3_output_reg_norm_rem_extra.csv`.

### Filling Missing Data
1. Run `fill_missing_classification.ipynb` to fill missing data in `3_output_class_rem_extra.csv`. The filled CSV files will be saved in the `4_out_csvs_classification` folder.
2. Run `fill_missing_regression.ipynb` to fill missing data in `3_output_reg_rem_extra.csv` or `3_output_reg_norm_rem_extra.csv`. The filled CSV files will be saved in the `4_out_csvs_regression` or `4_out_csvs_regression_norm` folders.
3. These files can then be used for training the classication and regression models. A file named `csv2txt.ipynb` can be found in both regression folders to create txt files, which can be used for Tetrad.

## Future Enhancements
- Adding more advanced data preprocessing methods.
- Improving the feature selection and ensemble learning techniques.
- Extending data filling methods to include more sophisticated imputation techniques.

For any issues or contributions, please open an issue or submit a pull request on GitHub.
